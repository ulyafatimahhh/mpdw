## White Noise

Pembangkitan data berpola AR, MA, ARMA, dan banyak proses deret waktu lainnya diawali pembangkitan *white noise*. *White noise* merupakan sederet nilai dari peubah bebas stokastik identik. Oleh karena itu, *white noise* memiliki dua karakteristik penting:

1.  *White noise* tidak memiliki autokorelasi (**karena saling bebas**)
2.  Nilai harapan dan ragam *white noise* sama (**karena berasal dari peubah acak bebas stokastik identik**)

*White noise* dibangkitkan dari suatu peubah acak, umumnya peubah acak normal.

## Proses MA

## Pembangkitan Proses MA(2)

```{r}
# Secara manual
library(forecast)
library(TSA)
library(ggplot2)
set.seed(24)
wn <- rnorm(300)
ma_manual <- rep(0, 300)
ma_manual[1] <- wn[1]
ma_manual[2] <- wn[2] - 0.4 * wn[1]
```

$$
y_t = e_t-0.4e_{t-1}-0.6e_{t-2}
$$

```{r}
for(i in 3:300){
   ma_manual[i] <- wn[i] - 0.4 * wn[i - 1] - 0.6 * wn[i - 2]
}
ma_manual
```


```{r}
# Fungsi arima.sim 
set.seed(24)
ma_fungsi <- arima.sim(list(order=c(0,0,2), ma= c(0.4, 0.6)), n=300)
ma_fungsi
```
# Karakteristik MA(2)

```{r}
# Plot Time Series
ts.plot(ma_manual)
```
Dilihat dari plot time series, data MA(2) yang dibangkitkan stasioner dalam rataan.

```{r}
# Plot ACF
acf(ma_manual,lag.max = 20)
```
Dilihat dari plot ACF tersebut, plot ACF *cuts off* di lag kedua.

```{r}
# Plot PACF
pacf(ma_manual)
```
Dilihat dari plot PACF tersebut, plot PACF cenderung *tails off* dan membentuk gelombang sinus

```{r}
# Plot EACF
TSA::eacf(ma_manual)
```
Dilihat pola segitiga nol pada plot EACF, disimpulkan segitiga nol berada pada ordo AR(0) dan ordo MA(2).

## Scatterplot antar lag

Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
#Yt
yt_ma <- ma_manual[-1]
yt_ma
#Yt-1
yt_1_ma <- ma_manual[-300]
yt_1_ma
plot(y=yt_ma,x=yt_1_ma)
```
Dilihat dari scatterplot tersebut, terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada


```{r}
cor(yt_ma,yt_1_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu
$$
\rho_1 = \frac{-\theta_1 + \theta_1 \theta_2}{1 + \theta_1^2 + \theta_2^2} = \frac{-0.4 + (0.4)(0.6)  }{1 + 0.4^2 + 0.6^2} =-0.09486138
$$

Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
#Yt
yt_ma2 <- ma_manual[-c(1,2)]
yt_ma2
#Yt-2
yt_2_ma <- ma_manual[-c(299,300)]
yt_2_ma
plot(y=yt_ma2,x=yt_2_ma)
```
Dilihat dari scatterplot tersebut, terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-2}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ma2,yt_2_ma)
```
Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu
$$
\rho_2 = \frac{-\theta_2}{1 + \theta_1^2 + \theta_2^2} = \frac{-0.6 }{1 + 0.4^2 + 0.6^2} =-0.3902639
$$

Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
#Yt
yt_ma3 <- ma_manual[-c(1,2,3)]
yt_ma3
#Yt-3
yt_3_ma <- ma_manual[-c(298,299,300)]
yt_3_ma
plot(y=yt_ma3,x=yt_3_ma)
```
Dilihat dari scatterplot tersebut, terlihat cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_ma3,yt_3_ma)
```
Korelasi antara $Y_t$ dengan $Y_{t-3}$ hasil simulasi mendekati teori yang ada yaitu 0.

# Proses AR

## Pembangkitan Proses AR(2)

```{r}
# Secara manual
set.seed(24)
ar_manual <- rep(0, 300)   # siapkan vektor kosong
ar_manual[1] <- wn[1]
ar_manual[2] <- wn[2] + 0.5 * ar_manual[1]
```

$$ Y_t = e_t+0.5e_{t-1}+0.2e_{t-2} $$

```{r}
for(i in 3:300){
  ar_manual[i] <- wn[i] + 0.5 * ar_manual[i-1] + 0.3 * ar_manual[i-2]
}
ar_manual
```

```{r}
## Fungsi arima.sim
set.seed(24)
ar2 <- arima.sim(list(order=c(2,0,0), ar=c(0.5,0.2)), n=300)
ar2
```

## Karakterisik AR(2)

```{r}
# Plot Time Series
ts.plot(ar_manual)
```

Dilihat dari plot time series tersebut, data cenderung stasioner pada rataan.

```{r}
# Plot ACF
acf(ar_manual)
```
Dilihat dari plot ACF tersebut, plot ACF cenderung tails off dan cenderung membentuk pola grafik sinus.

```{r}
# Plot PACF
pacf(ar_manual)
```
Dilihat dari plot PACF tersebut, plot PACF cuts off pada lag kedua, sejalan dengan teori yang ada.

```{r}
# Plot EACF
TSA::eacf(ar_manual)
```
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(2) dan ordo MA(0).

## Scatterplot Antar Lag

Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
#Yt
yt_ar <- ar_manual[-1]
yt_ar
#Yt-1
yt_1_ar <- ar_manual[-300]
yt_1_ar
```

```{r}
plot(y=yt_ar,x=yt_1_ar)
```

Dilihat dari scatterplot tersebut, terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada.

```{r}
cor(yt_ar,yt_1_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu
$$
\rho_{1} = \frac{\phi_{1}}{1 - \phi_{2}} = \frac{0.5}{1 - 0.2} =  0.6403175
$$

Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
#Yt
yt_ar2 <- ar_manual[-c(1,2)]
yt_ar2
#Yt-2
yt_2_ar <- ar_manual[-c(299,300)]
yt_2_ar
```

```{r}
plot(y=yt_ar2,x=yt_2_ar)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar2,yt_2_ar)
```
Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu
$$
\rho_{2} = \frac{\phi_{2}(1 - \phi_{2}) + \phi_{1}^{2}}{1 - \phi_{2}} = \frac{0.2(1 - 0.2) + 0.5^{2}}{1 - 0.2} = 0.5725975
$$

Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
#Yt
yt_ar3 <- ar_manual[-c(1,2,3)]
yt_ar3
#Yt-3
yt_3_ar <- ar_manual[-c(298,299,300)]
yt_3_ar
```

```{r}
plot(y=yt_ar3,x=yt_3_ar)
```
DIlihhat dari scatterplot tersebut, terdapat hubungan positif antara $Y_t$ dengan $Y_{t-3}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar3,yt_3_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_{3} = \phi_{1}\rho_{2} + \phi_{2}\rho_{1} = (0.5)(0.5125) + (0.2)(0.625) = 0.4371455
$$

# Proses ARMA
## Pembangkitan Proses ARMA (2,2)

$$ Y_t = 0.5Y_{t-1}+0.2Y_{t-2}+e_t-0.4_{t-1}-0.6_{t-2} $$
```{r}
# Secara manual
set.seed(24)
phi1 = 0.5
phi2 = 0.2
theta1 = 0.4
theta2 = 0.6

y.arma=c(1:300)
for (i in 3:300){y.arma[i] = phi1*y.arma[i-1] + phi2*y.arma[i-2] +
                 wn[i] - theta1*wn[i-1] - theta2*wn[i-2]}
y.arma
```

```{r}
# Fungsi arima.sim
arma22 <- arima.sim(list(order=c(2,0,2), ar = c(0.5,0.2), ma = c(0.4,0.6)), n=300)
arma22
```

## Karakterisik ARMA(2,2)

```{r}
# Plot time series
ts.plot(y.arma)
```
Dilihat dari plot time series tersebut, model ARMA(2,2) cenderung stasioner dalam rataan.

```{r}
# Plot ACF
acf(y.arma)
```
Dilihat dari plot ACF tersebut, model ARMA(2,2) hasil simulasi memiliki plot ACF yang *tails off*.

```{r}
# Plot PACF
pacf(y.arma)
```
Dilihat dari plot PACF tersebut, model ARMA(2,2) hasil simulasi memiliki plot PACF yang *tails off*.

```{r}
# Plot EACF
TSA::eacf(y.arma)
```
Dilihat dari pola segitiga nol pada plot EACF, disimpulkan segitiga nol berada pada ordo AR(2) dan ordo MA(2).

## Scatter Antar Lag

Korelasi antara $Y_t$ dengan $Y_{t-1}$


```{r}
#Yt
yt_arma <- arma22[-1]
yt_arma
#Yt-1
yt_1_arma <- arma22[-300]
yt_1_arma
```

```{r}
plot(y=yt_arma,x=yt_1_arma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada.

```{r}
cor(yt_arma,yt_1_arma)
```
Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1 = \frac{\phi_1 \gamma_0 + \phi_2 \gamma_1 + \sigma^2 \psi_1}{\gamma_0} = 0.859442
$$

Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
#Yt
yt_arma2 <- arma22[-c(1,2)]
yt_arma2
#Yt-1
yt_2_arma <- arma22[-c(299,300)]
yt_2_arma
```

```{r}
plot(y=yt_arma2,x=yt_2_arma)
```
Dilihat dari scatterplot tersebut, terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_arma2,yt_2_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu
$$
\rho_2 = \frac{\phi_1 \gamma_1 + \phi_2 \gamma_0 + \sigma^2 \psi_2}{\gamma_0} =0.6916136
$$
Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
#Yt
yt_arma3 <- arma22[-c(1,2,3)]
yt_arma3
#Yt-1
yt_3_arma <- arma22[-c(298,299,300)]
yt_3_arma
```

```{r}
plot(y=yt_arma3,x=yt_3_arma)
```
Dilihat dari scatterplot tersebut, terdapat hubungan positif antara $Y_t$ dengan $Y_{t-3}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_arma3,yt_3_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_3 = \frac{\phi_1 \gamma_2 + \phi_2 \gamma_1 + \sigma^2 \psi_3}{\gamma_0} = 0.4502802
$$

```{r}
# Parameter
phi <- c(0.5, 0.2)       
theta <- c(0.4, 0.6)

acf_theory <- ARMAacf(ar = phi, ma = theta, lag.max = 3)

rho1 <- round(acf_theory[2], 6)  # lag 1
rho2 <- round(acf_theory[3], 6)  # lag 2
rho3 <- round(acf_theory[4], 6)  # lag 3

rho1; rho2; rho3
```
